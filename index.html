<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Math Practice</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #f3f4f6;
      --card: #ffffff;
      --accent: #2563eb;
      --accent-soft: #dbeafe;
      --text-main: #111827;
      --text-muted: #6b7280;
      --border-soft: #e5e7eb;
      --danger: #b91c1c;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #e0ebff 0, #f4f5fb 45%, #eef2ff 100%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      justify-content: center;
    }

    .app-shell {
      width: 100%;
      max-width: 960px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 16px;
    }

    @media (min-width: 768px) {
      .app-shell { padding: 32px 24px; }
    }

    .app-container {
      flex: 1;
      background: var(--card);
      border-radius: 18px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12);
      padding: 20px 16px 24px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    @media (min-width: 768px) {
      .app-container {
        border-radius: 22px;
        padding: 24px 24px 28px;
      }
    }

    header.app-header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 1px solid var(--border-soft);
      padding-bottom: 10px;
    }

    .title-block { display: flex; flex-direction: column; gap: 2px; }

    .title-button {
      margin: 0;
      padding: 0;
      background: none;
      border: none;
      font-size: 1.6rem;
      font-weight: 800;
      letter-spacing: 0.03em;
      cursor: pointer;
      color: #111827;
      text-align: left;
    }

    .title-button:hover { color: #1d4ed8; }

    .subtitle {
      margin: 0;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-top: 6px;
    }

    footer.app-footer {
      margin-top: 10px;
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .card {
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      background: #f9fafb;
      padding: 14px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .home-card {
      background: radial-gradient(circle at top left, #fee2e2 0, #fef3c7 35%, #e0f2fe 100%);
      border: none;
      box-shadow: 0 14px 32px rgba(30, 64, 175, 0.25);
      position: relative;
      overflow: hidden;
    }

    .home-card::before,
    .home-card::after {
      content: "";
      position: absolute;
      border-radius: 999px;
      opacity: 0.18;
      filter: blur(1px);
    }

    .home-card::before {
      width: 140px;
      height: 140px;
      background: #f97316;
      top: -40px;
      right: -20px;
    }

    .home-card::after {
      width: 120px;
      height: 120px;
      background: #22c55e;
      bottom: -50px;
      left: -20px;
    }

    .home-card-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .home-heading-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .home-heading-main {
      font-size: 1.1rem;
      font-weight: 700;
      color: #111827;
    }

    .home-heading-note {
      font-size: 0.85rem;
      color: #374151;
    }

    .home-emoji-badge {
      font-size: 1.4rem;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 999px;
      padding: 6px 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .home-emoji-badge span {
      font-size: 0.85rem;
      color: #4b5563;
    }

    .field-row {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    @media (min-width: 640px) {
      .field-row {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.9rem;
    }

    label {
      font-weight: 600;
      color: var(--text-main);
    }

    .home-card label {
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }

    select,
    input[type="number"] {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      font-size: 0.95rem;
      outline: none;
      background: #ffffff;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    select:focus,
    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.25);
      background: #f9fafb;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.15s ease;
    }

    .btn-primary {
      background: linear-gradient(90deg, #2563eb, #4f46e5);
      color: #ffffff;
      box-shadow: 0 12px 22px rgba(37, 99, 235, 0.35);
      white-space: nowrap;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(37, 99, 235, 0.42);
      background: linear-gradient(90deg, #1d4ed8, #4338ca);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 8px 16px rgba(37, 99, 235, 0.35);
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
      box-shadow: none;
    }

    .btn-secondary:hover { background: #d1d5db; }

    .actions-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-start;
      margin-top: 6px;
    }

    .helper-text {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .home-card .helper-text {
      color: #4b5563;
      text-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);
    }

    .screen {
      display: none;
      flex-direction: column;
      gap: 12px;
    }

    .screen.active { display: flex; }

    .info-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      font-size: 0.82rem;
      color: var(--text-muted);
    }

    .info-row span { margin-right: 10px; }

    .badge {
      padding: 4px 10px;
      border-radius: 999px;
      background: #e5e7eb;
      font-size: 0.78rem;
    }

    .quiz-layout {
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      background: #ffffff;
      padding: 16px 14px 18px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-height: 220px;
    }

    @media (min-width: 768px) {
      .quiz-layout { padding: 18px 18px 20px; }
    }

    .quiz-top {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 0.86rem;
      color: var(--text-muted);
    }

    .quiz-top-left,
    .quiz-top-right {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
      margin-top: 4px;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #2563eb, #4f46e5);
      transition: width 0.25s ease;
    }

    .question-text {
      font-size: 1.1rem;
      margin-top: 4px;
      white-space: pre-wrap;
    }

    .answer-row {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .answer-input { max-width: 220px; }

    .feedback {
      min-height: 20px;
      font-size: 0.9rem;
      margin-top: 4px;
    }

    .feedback.error { color: var(--danger); }
    .feedback.info { color: var(--text-muted); }

    .correct-flash {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.2rem;
      font-weight: 800;
      z-index: 50;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease, transform 0.2s ease;
      text-shadow: 0 2px 6px rgba(15, 23, 42, 0.25);
    }

    .correct-flash.visible {
      opacity: 1;
      transform: translate(-50%, -52%);
    }

    .help-panel {
      margin-top: 8px;
      padding: 10px 10px 10px;
      border-radius: 10px;
      background: #f3f4ff;
      border: 1px solid #e0e7ff;
      font-size: 0.9rem;
      display: none;
      flex-direction: column;
      gap: 6px;
    }

    .help-panel.visible { display: flex; }

    .help-heading {
      font-weight: 600;
      color: #1e3a8a;
      font-size: 0.9rem;
    }

    .help-example {
      font-size: 0.86rem;
      color: #374151;
      white-space: pre-wrap;
    }

    .divider {
      height: 1px;
      background: #e5e7eb;
      margin: 8px 0;
    }

    .small-link-btn {
      border: none;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.78rem;
      background: #e0e7ff;
      color: #1d4ed8;
      cursor: pointer;
      align-self: flex-start;
    }

    .result-card {
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      background: #ffffff;
      padding: 16px 14px 18px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .result-section-title {
      font-size: 0.92rem;
      font-weight: 700;
      color: #111827;
    }

    .result-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px 16px;
      font-size: 0.9rem;
      color: #111827;
    }

    .result-label { color: var(--text-muted); margin-right: 4px; }

    .hidden { display: none !important; }

    @media (max-width: 480px) {
      .title-button { font-size: 1.3rem; }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <div class="app-container">
      <header class="app-header">
        <div class="title-block">
          <button id="home-title-btn" class="title-button">Math Practice</button>
          <p class="subtitle">Math Practice from Grade 1 to Grade 12</p>
        </div>
      </header>

      <main>
        <!-- HOME SCREEN -->
        <section id="home-screen" class="screen active">
          <div class="card home-card">
            <div class="home-card-inner">
              <div class="home-heading-row">
                <div>
                  <div class="home-heading-main">Choose your practice</div>
                  <div class="home-heading-note">
                    Pick a grade, topic, and number. Higher numbers = more challenge.
                  </div>
                </div>
                <div class="home-emoji-badge">
                  ðŸŽ“ <span>Daily math training</span>
                </div>
              </div>

              <div class="field-row">
                <div class="field">
                  <label for="grade-select">Grade</label>
                  <select id="grade-select">
                    <option value="">Select grade</option>
                    <option value="1">Grade 1</option>
                    <option value="2">Grade 2</option>
                    <option value="3">Grade 3</option>
                    <option value="4">Grade 4</option>
                    <option value="5">Grade 5</option>
                    <option value="6">Grade 6</option>
                    <option value="7">Grade 7</option>
                    <option value="8">Grade 8</option>
                    <option value="9">Grade 9</option>
                    <option value="10">Grade 10</option>
                    <option value="11">Grade 11</option>
                    <option value="12">Grade 12</option>
                  </select>
                </div>

                <div class="field">
                  <label for="progressive-select">Progressive (Topic)</label>
                  <select id="progressive-select">
                    <option value="">Select grade first</option>
                  </select>
                  <div class="helper-text">
                    7 topics per grade, aligned to US curriculum.
                  </div>
                </div>

                <div class="field">
                  <label for="number-input">Number (1â€“100)</label>
                  <input id="number-input" type="number" min="1" max="100" placeholder="1â€“100" />
                  <div class="helper-text">
                    Higher numbers = more complex problems in this topic.
                  </div>
                </div>
              </div>

              <div class="actions-row">
                <button id="start-quiz-btn" class="btn-primary">Start Quiz</button>
              </div>
              <div id="home-error" class="feedback error"></div>
            </div>
          </div>
        </section>

        <!-- QUIZ SCREEN -->
        <section id="quiz-screen" class="screen">
          <div class="quiz-layout">
            <div class="quiz-top">
              <div class="quiz-top-left">
                <span class="badge" id="quiz-grade-topic"></span>
                <span class="badge" id="quiz-number-label"></span>
                <span class="badge" id="quiz-concept-label"></span>
              </div>
              <div class="quiz-top-right">
                <span>Quiz ID: <strong id="quiz-id"></strong></span>
              </div>
            </div>

            <div class="info-row">
              <span>Started: <span id="quiz-start-time"></span></span>
              <span>Elapsed: <span id="quiz-elapsed-time">00:00</span></span>
              <span>Question: <span id="quiz-question-counter">1 / 25</span></span>
            </div>

            <div class="progress-bar">
              <div id="quiz-progress-fill" class="progress-fill"></div>
            </div>

            <div class="divider"></div>

            <div id="quiz-question-block">
              <div id="quiz-question-text" class="question-text"></div>

              <div class="answer-row">
                <div class="field">
                  <label for="answer-input">Your answer</label>
                  <input id="answer-input" type="number" class="answer-input" />
                </div>

                <div class="actions-row">
                  <button id="submit-answer-btn" class="btn-primary">Submit Answer</button>
                  <button id="help-btn" class="btn-secondary">Help</button>
                </div>
                <div id="quiz-feedback" class="feedback info"></div>
              </div>

              <div id="help-panel" class="help-panel">
                <div class="help-heading">Hint</div>
                <div id="help-hint"></div>
                <button id="show-explanation-btn" class="small-link-btn">
                  Show full explanation with example
                </button>
                <div id="explanation-block" class="hidden">
                  <div class="divider"></div>
                  <div class="help-heading">Explanation (concept)</div>
                  <div id="help-explanation" class="help-example"></div>
                  <div class="help-heading">Example (step by step)</div>
                  <div id="help-example" class="help-example"></div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- RESULT SCREEN -->
        <section id="result-screen" class="screen">
          <div class="result-card">
            <div class="result-section-title">Quiz Summary</div>
            <div class="result-row">
              <div><span class="result-label">Grade:</span><span id="result-grade"></span></div>
              <div><span class="result-label">Progressive:</span><span id="result-progressive"></span></div>
            </div>
            <div class="result-row">
              <div><span class="result-label">Topic:</span><span id="result-topic"></span></div>
              <div><span class="result-label">Number:</span><span id="result-number"></span></div>
            </div>
            <div class="result-row">
              <div><span class="result-label">Quiz ID:</span><span id="result-quiz-id"></span></div>
            </div>

            <div class="divider"></div>

            <div class="result-section-title">Time</div>
            <div class="result-row">
              <div><span class="result-label">Started:</span><span id="result-started"></span></div>
            </div>
            <div class="result-row">
              <div><span class="result-label">Finished:</span><span id="result-finished"></span></div>
            </div>
            <div class="result-row">
              <div><span class="result-label">Total time:</span><span id="result-total-time"></span></div>
              <div><span class="result-label">Avg per question:</span><span id="result-avg-time"></span></div>
            </div>

            <div class="divider"></div>

            <div class="result-section-title">Learning Metrics</div>
            <div class="result-row">
              <div><span class="result-label">First-try correct:</span><span id="result-first-try"></span></div>
            </div>
            <div class="result-row">
              <div><span class="result-label">Questions needing multiple attempts:</span><span id="result-multi-attempt"></span></div>
            </div>
            <div class="result-row">
              <div><span class="result-label">Questions with help used:</span><span id="result-help-used"></span></div>
            </div>

            <div class="divider"></div>
            <div id="result-summary-line"></div>

            <div class="actions-row" style="margin-top: 10px;">
              <button id="retry-btn" class="btn-secondary">Try this Number again</button>
              <button id="next-number-btn" class="btn-primary">Next Number</button>
              <button id="back-home-btn" class="btn-secondary">Back to Home</button>
            </div>
          </div>
        </section>
      </main>
    </div>

    <footer class="app-footer">
      Made by Ten Daddy
    </footer>

    <div id="correct-flash" class="correct-flash">Awesome!</div>

    <!-- Optional audio files (add correct.mp3, result-melody.mp3 in same folder if you want sound) -->
    <audio id="correct-sound" src="correct.mp3" preload="auto"></audio>
    <audio id="result-sound" src="result-melody.mp3" preload="auto"></audio>
  </div>

  <!-- Script order matters -->
  <script src="js/utils.js"></script>
  <script src="js/generators/core.js"></script>
  <script src="js/curriculum.js"></script>
  <script src="js/engine.js"></script>
</body>
</html>
